<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Migo - Fluent & Rounded</title>
    <style>
        :root {
            --bright-yellow: #fffde7;
            --joy-yellow: #fff59d;
            --soft-green: #cedad0;
            --active-green: #4caf50;
            --joy-orange: #ff9800;
            --sidebar-joy: #fbc02d;
            --error-red: #ff5252;
            --text-main: #37474f;
            --border-radius: 15px; /* Esqunas redondeadas según fotos */
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            margin: 0; height: 100vh;
            background-color: #a5b7a9; /* Color de fondo de la captura */
            display: flex; overflow: hidden; color: var(--text-main);
            padding: 10px; box-sizing: border-box;
        }

        .app-container { display: flex; flex: 1; gap: 10px; width: 100%; }

        /* SECCIONES PRINCIPALES CON BORDES REDONDEADOS */
        .section-card {
            background: white;
            border-radius: var(--border-radius);
            display: flex; flex-direction: column;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        /* REGISTRO IZQUIERDA */
        .record-fixed { width: 250px; }
        
        /* CHAT CENTRAL */
        .chat-container { flex: 1; position: relative; }

        /* LÍNEA AMARILLA ALINEADA */
        .header-unit {
            height: 60px; display: flex; align-items: center;
            border-bottom: 2px solid var(--joy-yellow);
            padding: 0 15px; background: white;
            flex-shrink: 0;
        }

        .header-title { font-weight: bold; font-size: 14px; color: #555; text-transform: uppercase; }

        /* MENSAJES */
        .chat-messages { flex: 1; padding: 15px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; background: #f0f4f1; }
        .message { padding: 10px 15px; border-radius: 12px; max-width: 80%; font-size: 15px; line-height: 1.4; }
        .migo { background: white; align-self: flex-start; border-bottom-left-radius: 2px; }
        .user { background: #dcf8c6; align-self: flex-end; border-bottom-right-radius: 2px; }

        /* INPUT */
        .input-area { padding: 10px 15px; background: white; border-top: 1px solid #eee; }
        .input-wrapper { 
            display: flex; align-items: center; background: #f8f9fa; 
            border-radius: 20px; padding: 5px 15px;
        }
        .input-wrapper textarea { flex: 1; border: none; background: transparent; outline: none; padding: 8px; resize: none; font-size: 14px; }

        /* PANELES LATERALES DERECHOS */
        .side-panels { width: 300px; display: flex; flex-direction: column; gap: 10px; }

        .floating-panel {
            background: white; border-radius: var(--border-radius);
            display: flex; flex-direction: column; padding: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .arrow-btn { cursor: pointer; fill: #999; transform: rotate(180deg); transition: 0.2s; } /* Flecha hacia la derecha */
        .arrow-btn:hover { fill: var(--active-green); }

        /* TRADUCTOR ESTILO FOTO */
        .trans-box { background: #f1f3f4; padding: 10px; border-radius: 8px; margin-bottom: 8px; }
        .trans-box input { width: 100%; border: none; background: transparent; outline: none; font-size: 14px; }
        .trans-res { color: #1a73e8; font-size: 14px; margin-top: 5px; min-height: 18px; }

        /* MENU OPCIONES (FOTO) */
        #panel-options {
            display: none; position: absolute; top: 70px; right: 10px; 
            width: 220px; z-index: 2000; padding: 10px 0;
        }
        .option-item {
            display: flex; align-items: center; gap: 12px; padding: 10px 20px;
            cursor: pointer; transition: 0.2s; font-size: 14px;
        }
        .option-item:hover { background: #f5f5f5; }
        .option-item svg { width: 18px; fill: #5f6368; }
        .red-text { color: #d93025; }

        /* LOGS */
        .log-entry { font-size: 12px; padding: 8px; border-bottom: 1px solid #eee; }
        .log-time { font-size: 10px; color: #999; display: block; }

        .icon-btn { cursor: pointer; background: none; border: none; padding: 5px; display: flex; align-items: center; }
        .icon-btn svg { width: 20px; height: 20px; fill: #5f6368; }

        .wrapper-locked { border: 2px solid var(--error-red) !important; background: #fff1f0 !important; }
    </style>
</head>
<body>

<div class="app-container">
    <div class="section-card record-fixed">
        <div class="header-unit"><span class="header-title">Registro Errores</span></div>
        <div id="error-log" style="overflow-y: auto; flex: 1;"></div>
    </div>

    <div class="section-card chat-container">
        <header class="header-unit" style="justify-content: space-between;">
            <div style="display: flex; align-items: center; gap: 10px;">
                <span class="header-title">Migo App</span>
            </div>
            <div style="display: flex; gap: 5px;">
                <button class="icon-btn" onclick="togglePanel('panel-translator')">
                    <svg viewBox="0 0 24 24"><path d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>
                </button>
                <button class="icon-btn" onclick="toggleOptions()">
                    <svg viewBox="0 0 24 24"><path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/></svg>
                </button>
            </div>
        </header>

        <div class="chat-messages" id="chat">
            <div class="message migo">Hello! I'm Migo. Let's talk in English. If you make a mistake like "helo", I will help you correct it.</div>
        </div>

        <div class="input-area">
            <div class="input-wrapper" id="main-input-wrap">
                <textarea id="userInput" rows="1" placeholder="Type here in English..." onkeypress="handleChatKey(event)"></textarea>
                <button class="icon-btn" onclick="sendMessage()">
                    <svg viewBox="0 0 24 24" fill="#1a73e8"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"></path></svg>
                </button>
            </div>
        </div>

        <div id="panel-options" class="floating-panel">
            <div style="padding: 0 20px 10px; font-weight: bold; font-size: 16px;">Opciones</div>
            <div class="option-item">
                <svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                Perfil de Sergi
            </div>
            <div class="option-item">
                <svg viewBox="0 0 24 24"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z"/></svg>
                Modo Estricto ON
            </div>
            <div class="option-item red-text" onclick="location.reload()">
                <svg viewBox="0 0 24 24" fill="#d93025"><path d="M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/></svg>
                Reiniciar App
            </div>
        </div>
    </div>

    <div class="side-panels">
        <div id="panel-translator" class="section-card" style="flex: 1;">
            <div class="header-unit" style="justify-content: space-between;">
                <span class="header-title">Traductor Pro</span>
                <svg class="arrow-btn" onclick="togglePanel('panel-translator')" width="20" height="20" viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg>
            </div>
            <div style="padding: 15px;">
                <div class="trans-box">
                    <div style="font-size: 11px; color: #777;">Español > Inglés</div>
                    <input type="text" id="es-in" placeholder="Escribe aquí..." onkeypress="if(event.key==='Enter') runTranslate('es','en')">
                    <div class="trans-res" id="es-out"></div>
                </div>
                <div class="trans-box">
                    <div style="font-size: 11px; color: #777;">Inglés > Español</div>
                    <input type="text" id="en-in" placeholder="Type here..." onkeypress="if(event.key==='Enter') runTranslate('en','es')">
                    <div class="trans-res" id="en-out"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    let isLocked = false;
    let requiredWord = "Hello";

    function togglePanel(id) {
        const p = document.getElementById(id);
        p.style.display = p.style.display === 'none' ? 'flex' : 'none';
    }

    function toggleOptions() {
        const p = document.getElementById('panel-options');
        p.style.display = p.style.display === 'block' ? 'none' : 'block';
    }

    async function runTranslate(sl, tl) {
        const text = document.getElementById(sl+'-in').value;
        const out = document.getElementById(sl+'-out');
        if(!text) return;
        const res = await fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=${sl}&tl=${tl}&dt=t&q=${encodeURIComponent(text)}`);
        const data = await res.json();
        out.innerText = data[0][0][0];
    }

    function handleChatKey(e) { if(e.key === 'Enter') { e.preventDefault(); sendMessage(); } }

    function sendMessage() {
        const input = document.getElementById('userInput');
        const text = input.value.trim();
        const wrap = document.getElementById('main-input-wrap');
        if(!text) return;

        if(isLocked) {
            if(text.toLowerCase() === "hello") {
                addMsg(text, 'user');
                isLocked = false;
                wrap.classList.remove('wrapper-locked');
                setTimeout(() => addMsg("Great! You fixed it. Let's continue our English conversation.", "migo"), 600);
            } else {
                addMsg("Please, write 'Hello' correctly to continue.", "migo");
            }
            input.value = '';
            return;
        }

        addMsg(text, 'user');

        if(text.toLowerCase().includes("helo")) {
            isLocked = true;
            wrap.classList.add('wrapper-locked');
            addToLog("helo", "Hello");
            setTimeout(() => addMsg("Wait! You made a mistake. Please write 'Hello' to unlock the chat.", "migo"), 600);
        } else {
            // Conversación Fluida en Inglés
            setTimeout(() => {
                const responses = [
                    "That's interesting! Tell me more about that.",
                    "I see. You are expressing yourself very well in English.",
                    "I agree. Practice is the key to success!",
                    "That sounds great. Do you have any other plans for today?",
                    "Nice! I'm enjoying our conversation."
                ];
                addMsg(responses[Math.floor(Math.random() * responses.length)], "migo");
            }, 800);
        }
        input.value = '';
    }

    function addMsg(t, type) {
        const chat = document.getElementById('chat');
        const div = document.createElement('div');
        div.className = `message ${type}`;
        div.innerText = t;
        chat.appendChild(div);
        chat.scrollTop = chat.scrollHeight;
    }

    function addToLog(m, c) {
        const log = document.getElementById('error-log');
        const now = new Date();
        const time = now.toLocaleDateString() + " " + now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        const entry = document.createElement('div');
        entry.className = "log-entry";
        entry.innerHTML = `<span class="log-time">${time}</span> ❌ <b>${m}</b> → ✅ <b>${c}</b>`;
        log.prepend(entry);
    }
</script>
</body>
</html>