<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Migo App - Interactividad Total</title>
    <style>
        :root {
            --bg-color: #76c1a5;
            --panel-bg: #f1f5f9;
            --chat-bg: #ffffff;
            --accent: #1e293b;
            --error-red: #ef4444;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            margin: 0;
            height: 100vh;
            background-color: var(--bg-color);
            background-image: url("https://www.transparenttextures.com/patterns/doodle-weave.png");
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 25px;
            background: rgba(255,255,255,0.15);
        }

        .logo { font-size: 20px; font-weight: bold; color: #1a2a3a; }
        .top-buttons { display: flex; gap: 8px; }
        
        .btn { 
            background: var(--accent); color: white; border: none; 
            padding: 7px 14px; border-radius: 6px; cursor: pointer; font-size: 12px;
        }

        .main-layout {
            display: flex;
            padding: 15px;
            flex: 1;
            gap: 15px;
            height: 82vh;
        }

        /* Panel RECORD (Izquierda Fijo - Estrecho) */
        .record-fixed {
            width: 160px; 
            background: var(--panel-bg);
            border-radius: 15px;
            padding: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            overflow-y: auto;
        }

        /* CHAT CENTRAL */
        .chat-container {
            flex: 1;
            background: var(--chat-bg);
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        /* PANELES DERECHOS (Independientes - Muy Estrechos) */
        .side-panel-right {
            width: 0;
            opacity: 0;
            visibility: hidden;
            overflow: hidden;
            background: var(--panel-bg);
            border-radius: 15px;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .side-panel-right.active {
            width: 180px; 
            opacity: 1;
            visibility: visible;
            padding: 12px;
        }

        .sub-win { background: white; padding: 10px; border-radius: 8px; border: 1px solid #e2e8f0; }
        .res-box { 
            background: #f8fafc; padding: 6px; border-radius: 4px; 
            margin-top: 5px; font-size: 11px; color: #1e40af; 
            min-height: 18px; border-left: 3px solid var(--bg-color);
        }
        
        textarea { width: 100%; border: 1px solid #ddd; border-radius: 4px; padding: 5px; font-size: 11px; resize: none; box-sizing: border-box; outline: none; }
        textarea:focus { border-color: var(--bg-color); }

        /* Mensajes de Chat */
        .chat-messages { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
        .message { padding: 10px 14px; border-radius: 12px; max-width: 85%; font-size: 14px; }
        .migo { align-self: flex-start; background: #f1f3f4; color: #1e293b; border-bottom-left-radius: 2px; }
        .user { align-self: flex-end; background: #dbeafe; color: #1e40af; border-bottom-right-radius: 2px; }
        .hint { color: var(--error-red); font-weight: bold; font-size: 11px; display: block; margin-top: 4px; }

        .input-area { padding: 15px; border-top: 1px solid #f1f5f9; display: flex; gap: 8px; }
        input[type="text"] { flex: 1; padding: 12px; border: 1px solid #e2e8f0; border-radius: 10px; outline: none; }
        
        h3 { font-size: 11px; margin: 0 0 8px 0; color: #475569; text-transform: uppercase; }
    </style>
</head>
<body>

    <header>
        <div class="logo">Migo App</div>
        <div class="top-buttons">
            <button class="btn" onclick="toggleRightPanel('translator')">Traductor</button>
            <button class="btn" onclick="toggleRightPanel('settings')">Settings</button>
        </div>
    </header>

    <div class="main-layout">
        <div class="record-fixed">
            <h3>Record</h3>
            <div id="error-log" style="font-size: 11px; color: #64748b;">No mistakes yet.</div>
        </div>

        <div class="chat-container">
            <div class="chat-messages" id="chat">
                <div class="message migo">Hi! I'm Migo. Let's practice. Escribe algo como "Hello", "How are you?" o comete un error como "helo".</div>
            </div>
            <div class="input-area">
                <input type="text" id="userInput" placeholder="Type and press Enter..." onkeypress="handleChatKey(event)">
                <button class="btn" onclick="sendMessage()">Send</button>
            </div>
        </div>

        <div id="panel-translator" class="side-panel-right">
            <h3>Traducción</h3>
            <div class="sub-win">
                <strong>ESP > ENG</strong>
                <textarea id="es-en-in" rows="2" placeholder="Pulsa Intro..." onkeypress="handleTransKey(event, 'es-en')"></textarea>
                <div class="res-box" id="es-en-out">...</div>
            </div>
            <div class="sub-win">
                <strong>ENG > ESP</strong>
                <textarea id="en-es-in" rows="2" placeholder="Press Enter..." onkeypress="handleTransKey(event, 'en-es')"></textarea>
                <div class="res-box" id="en-es-out">...</div>
            </div>
        </div>

        <div id="panel-settings" class="side-panel-right">
            <h3>Settings</h3>
            <div class="sub-win">Profile</div>
            <div class="sub-win">Theme</div>
        </div>
    </div>

    <script>
        // Diccionario para demostración
        const dictionary = {
            "hola": "hello", "casa": "house", "coche": "car", "adiós": "goodbye",
            "hello": "hola", "house": "casa", "car": "coche", "helo": "hello",
            "how are you": "cómo estás", "fine": "bien"
        };

        // --- LÓGICA DE PANELES ---
        function toggleRightPanel(id) {
            const t = document.getElementById('panel-translator');
            const s = document.getElementById('panel-settings');
            if (id === 'translator') { t.classList.toggle('active'); s.classList.remove('active'); }
            else { s.classList.toggle('active'); t.classList.remove('active'); }
        }

        // --- LÓGICA DE TRADUCCIÓN (CON INTRO) ---
        function handleTransKey(e, mode) {
            if (e.key === 'Enter') {
                e.preventDefault(); // Evita el salto de línea
                const inputId = mode === 'es-en' ? 'es-en-in' : 'en-es-in';
                const outputId = mode === 'es-en' ? 'es-en-out' : 'en-es-out';
                const val = document.getElementById(inputId).value.toLowerCase().trim();
                document.getElementById(outputId).innerText = dictionary[val] || "Not in dictionary";
            }
        }

        // --- LÓGICA DE CONVERSACIÓN ---
        function handleChatKey(e) { if (e.key === 'Enter') sendMessage(); }

        function sendMessage() {
            const input = document.getElementById('userInput');
            const text = input.value.trim();
            if (!text) return;

            addMsg(text, 'user');
            processMigoResponse(text);
            input.value = '';
        }

        function processMigoResponse(userText) {
            const lowerText = userText.toLowerCase();
            setTimeout(() => {
                let reply = "I'm not sure I understand, but let's keep talking!";
                let hint = null;

                // Respuestas inteligentes basadas en palabras clave
                if (lowerText.includes("hello") || lowerText.includes("hi")) {
                    reply = "Hello there! How's your day going?";
                } else if (lowerText.includes("how are you")) {
                    reply = "I'm doing great, thank you for asking! Ready to learn?";
                } else if (lowerText === "helo") {
                    reply = "Hello!";
                    hint = "Migo suggests: 'Hello'";
                    addToRecord(userText, "Hello");
                } else if (lowerText.includes("car") || lowerText.includes("house")) {
                    reply = `Yes! That's a common word. Do you have a ${lowerText}?`;
                }

                addMsg(reply, 'migo', hint);
            }, 700);
        }

        // --- AUXILIARES ---
        function addMsg(text, type, hint = null) {
            const chat = document.getElementById('chat');
            const div = document.createElement('div');
            div.className = `message ${type}`;
            div.innerText = text;
            if (hint) {
                const s = document.createElement('span');
                s.className = 'hint';
                s.innerText = "⚠️ " + hint;
                div.appendChild(s);
            }
            chat.appendChild(div);
            chat.scrollTop = chat.scrollHeight;
        }

        function addToRecord(orig, fix) {
            const log = document.getElementById('error-log');
            if (log.innerText.includes("No mistakes")) log.innerHTML = "";
            const entry = document.createElement('div');
            entry.style = "background: white; padding: 8px; border-radius: 6px; margin-bottom: 6px; border-left: 3px solid var(--error-red); font-size: 11px;";
            entry.innerHTML = `<b>×</b> ${orig} <br> <b>✓</b> ${fix}`;
            log.prepend(entry);
        }
    </script>
</body>
</html>